mysql> create database s2;
Query OK, 1 row affected (0.01 sec)

mysql> use s2;
Database changed

mysql> source summer_hw_test/exercise.sql
...

mysql> alter table record add heat_w int;
Query OK, 0 rows affected (0.30 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> DESC record;
+---------------+--------------+------+-----+---------+----------------+
| Field         | Type         | Null | Key | Default | Extra          |
+---------------+--------------+------+-----+---------+----------------+
| id            | bigint       | NO   | PRI | NULL    | auto_increment |
| qid           | int          | NO   |     | NULL    |                |
| crawl_id      | bigint       | NO   | MUL | NULL    |                |
| hit_at        | double       | YES  |     | NULL    |                |
| ranking       | int          | NO   |     | NULL    |                |
| title         | varchar(255) | NO   |     | NULL    |                |
| heat          | varchar(20)  | NO   |     | NULL    |                |
| created       | int          | YES  |     | NULL    |                |
| visitCount    | int          | YES  |     | NULL    |                |
| followerCount | int          | YES  |     | NULL    |                |
| answerCount   | int          | YES  |     | NULL    |                |
| excerpt       | longtext     | YES  |     | NULL    |                |
| raw           | longtext     | YES  |     | NULL    |                |
| url           | varchar(255) | YES  |     | NULL    |                |
| heat_w        | int          | YES  |     | NULL    |                |
+---------------+--------------+------+-----+---------+----------------+
15 rows in set (0.00 sec)

mysql> update record set heat_w=replace(heat,'万热度','');
Query OK, 26144 rows affected (2.10 sec)
Rows matched: 26144  Changed: 26144  Warnings: 0

mysql> select title from record where title like '%高考%';
+--------------------------------------------------------------------------------------------------------------------------------------------------+
| title                                                                                                                                            |
+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 高考失败，想复读但最后又放弃复读的学长学姐们，你们现在后悔吗？                                                                                   |
| 上海高考 7 日开考，延期一个月后，上海考生需要注意哪些事项？                                                                                      |
| 高考没有考到理想的成绩怎么办，父母让我复读，可是我不想怎么办?                                                                                    |
| 全国高考生是怎么看待上海高考难度的？题目难度究竟如何？                                                                                           |
| 聊聊迟来的上海高考，今年与往年相比有哪些新变化？                                                                                                 |
| 如何评价 2022 年上海高考英语？                                                                                                                   |
| 高考 200 多分还要不要读大专，还是选择打工？                                                                                                      |
| 高考考砸了，是走专升本还是复读？                                                                                                                 |
| 高考真的不能用 0.38 的笔吗？                                                                                                                     |
| 如何看待张雪峰建议考生高考结束即可准备考研？                                                                                                     |
| 张雪峰回应「建议高考结束即可准备考研」，如何看待张雪峰这一观点？                                                                                 |
| 我是 2024 届高考考生，未来想当一位临床医生，我确定选了物理化学，请问是还有一门是选地理还是生物呢？                                               |
| 2022 年高考报志愿哪些专业就业前景比较好？作为过来人，你有什么经验分享？                                                                          |
+--------------------------------------------------------------------------------------------------------------------------------------------------+
13 rows in set (0.02 sec)

mysql> select hit_at,heat,visitCount,followerCount from record where qid = 507238700 order by hit_at;
+--------------------+---------------+------------+---------------+
| hit_at             | heat          | visitCount | followerCount |
+--------------------+---------------+------------+---------------+
| 1657268581.8068695 | 196万热度     |     111645 |            62 |
| 1657269181.6675248 | 203万热度     |     119784 |            67 |
| 1657269779.5129082 | 211万热度     |     129469 |            73 |
| 1657270377.3284876 | 223万热度     |     140700 |            79 |
| 1657270977.4000156 | 234万热度     |     151464 |            87 |
| 1657271577.8724403 | 246万热度     |     162405 |            95 |
|  1657272175.517476 | 261万热度     |     174230 |           101 |
| 1657272770.0413768 | 273万热度     |     187497 |           111 |
| 1657273367.7840288 | 289万热度     |     200589 |           126 |
| 1657273967.6625345 | 315万热度     |     214335 |           137 |
| 1657274567.8786178 | 337万热度     |     227606 |           153 |
| 1657275167.6941094 | 356万热度     |     237640 |           171 |
| 1657275768.1857357 | 268万热度     |     246523 |           181 |
| 1657276363.1592598 | 3690万热度    |     255622 |           196 |
| 1657276965.5624704 | 6011万热度    |     266991 |           211 |
|  1657277566.166609 | 6178万热度    |     278510 |           221 |
| 1657278165.8973649 | 6315万热度    |     292413 |           229 |
|  1657278766.136111 | 6454万热度    |     305741 |           240 |
| 1657279366.0047014 | 6575万热度    |     319986 |           248 |
|  1657279966.313949 | 6672万热度    |     335908 |           262 |
| 1657280566.1223137 | 6777万热度    |     352699 |           268 |
| 1657281166.0909085 | 6887万热度    |     370157 |           280 |
| 1657281766.4019017 | 6969万热度    |     389062 |           289 |
| 1657282366.6133711 | 7038万热度    |     408179 |           299 |
|  1657282966.661002 | 7091万热度    |     426905 |           306 |
| 1657283566.8831582 | 7995万热度    |     446189 |           313 |
|  1657284167.311673 | 8018万热度    |     465685 |           322 |
| 1657284767.1813874 | 8033万热度    |     485812 |           338 |
| 1657285791.6589212 | 7948万热度    |     518619 |           353 |
| 1657286391.4875367 | 7868万热度    |     538271 |           360 |
|  1657286991.430772 | 7788万热度    |     557652 |           375 |
| 1657287591.6401582 | 7700万热度    |     576731 |           385 |
|  1657288191.888017 | 7619万热度    |     595766 |           397 |
| 1657288791.6086504 | 7538万热度    |     615187 |           410 |
| 1657289391.7134857 | 6551万热度    |     633433 |           418 |
| 1657289991.8555038 | 6456万热度    |     651355 |           426 |
| 1657290591.9557889 | 6360万热度    |     669146 |           433 |
| 1657291192.0584714 | 3884万热度    |     686603 |           439 |
| 1657291792.1273022 | 3836万热度    |     703902 |           442 |
| 1657292392.5961173 | 3846万热度    |     720373 |           450 |
| 1657292992.3188443 | 3841万热度    |     737025 |           459 |
|  1657294192.369348 | 3841万热度    |     767977 |           480 |
| 1657294792.7912576 | 3825万热度    |     783014 |           486 |
| 1657295393.1498432 | 3801万热度    |     798000 |           497 |
|  1657295992.600902 | 3798万热度    |     812317 |           504 |
| 1657296592.9168026 | 3769万热度    |     826611 |           513 |
| 1657297192.7560103 | 3728万热度    |     840722 |           524 |
|  1657297793.286744 | 3745万热度    |     855232 |           534 |
| 1657298392.9101374 | 3763万热度    |     868457 |           539 |
| 1657298993.0469816 | 3765万热度    |     881200 |           549 |
| 1657299592.9760711 | 3766万热度    |     893881 |           556 |
| 1657300193.3904312 | 3754万热度    |     905833 |           561 |
| 1657300793.2746077 | 3709万热度    |     918419 |           569 |
| 1657301393.2855186 | 3656万热度    |     930338 |           574 |
| 1657301993.8404512 | 3606万热度    |     941985 |           577 |
|  1657302593.650528 | 3542万热度    |     953538 |           582 |
| 1657303193.4908147 | 3469万热度    |     965164 |           586 |
| 1657303793.6753943 | 3403万热度    |     976630 |           587 |
| 1657304393.6475942 | 3196万热度    |     987772 |           591 |
| 1657304993.8020835 | 2990万热度    |     998835 |           598 |
| 1657305594.0823412 | 2816万热度    |    1009580 |           602 |
| 1657306194.1515682 | 2631万热度    |    1020657 |           603 |
| 1657306794.0676718 | 2431万热度    |    1031434 |           605 |
| 1657307394.2488236 | 2294万热度    |    1041608 |           606 |
| 1657307994.1820219 | 2096万热度    |    1050707 |           607 |
| 1657308594.4001913 | 1907万热度    |    1058590 |           609 |
|  1657309194.452628 | 1752万热度    |    1066425 |           610 |
| 1657309794.3945704 | 1582万热度    |    1073140 |           610 |
|  1657310394.570403 | 1409万热度    |    1079425 |           612 |
| 1657310994.6731958 | 1278万热度    |    1085265 |           613 |
| 1657311594.7660794 | 1266万热度    |    1090431 |           616 |
| 1657312195.1426885 | 1255万热度    |    1094163 |           616 |
| 1657312794.8756073 | 1242万热度    |    1098256 |           617 |
| 1657313395.2173789 | 1228万热度    |    1101426 |           618 |
| 1657313995.2178009 | 1216万热度    |    1104256 |           618 |
| 1657314595.3031106 | 1205万热度    |    1106826 |           619 |
| 1657315195.2601287 | 1196万热度    |    1109698 |           620 |
| 1657315795.4904244 | 1187万热度    |    1111871 |           622 |
|   1657316395.66317 | 1183万热度    |    1114538 |           622 |
|  1657316995.499087 | 1180万热度    |    1117318 |           622 |
| 1657317595.6741853 | 1181万热度    |    1120009 |           625 |
| 1657318196.0114875 | 1185万热度    |    1123069 |           626 |
| 1657318796.0427902 | 1194万热度    |    1126959 |           627 |
| 1657319396.1626256 | 1212万热度    |    1131180 |           629 |
|  1657319996.242051 | 1235万热度    |    1136009 |           632 |
| 1657320596.4115958 | 1268万热度    |    1141494 |           636 |
| 1657321196.3361592 | 1300万热度    |    1147357 |           639 |
| 1657321796.6228907 | 1339万热度    |    1153867 |           643 |
|   1657322396.77547 | 831万热度     |    1161789 |           645 |
|  1657322996.664909 | 852万热度     |    1170356 |           648 |
|  1657323596.881634 | 545万热度     |    1179161 |           654 |
| 1657324197.1617715 | 564万热度     |    1188856 |           662 |
|   1657324797.20128 | 601万热度     |    1199574 |           668 |
| 1657325397.1114333 | 630万热度     |    1210561 |           672 |
| 1657325997.7003396 | 666万热度     |    1222845 |           677 |
+--------------------+---------------+------------+---------------+
95 rows in set (0.02 sec)

mysql> select title,COUNT(*) from record group by COUNT(*) having COUNT(*) > 100 order by COUNT(*) desc; 
+-----------------------------------------------------------------------------------------------------------------------------------------------------------+----------+
| title                                                                                                                                                     | COUNT(*) |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------+----------+
| 现在的房子都建二三十层高，将来房龄到了，老房子该怎么处理？                                                                                                |      213 |
| 已经 2022 年了，为什么我还是没觉得 5G 有多厉害，5G 究竟有什么实际用途？                                                                                   |      176 |
| 同样都是走高端路线，为什么钟薛高被骂上热搜，而哈根达斯却没有？                                                                                            |      163 |
| 如何看待在读博士被岳父举报「嫖娼成瘾」，校方回应称已启动调查？                                                                                            |      158 |
| 前是华为，后到比亚迪，为什么让国人承认国产优秀这么难？                                                                                                    |      136 |
| 《谭谈交通》在 B 站突然下线，谭乔或面临巨额赔偿，出了什么问题？                                                                                           |      135 |
| 如何看待恐怖片《咒》因诅咒情节太晦气上热搜？                                                                                                              |      129 |
| 如何看待武汉理工大学 2021 级专硕全部去襄阳进行为期一年的专业实践?                                                                                         |      125 |
| 安倍晋三遭枪击身亡，按照日本法律行凶者涉嫌何种罪名？会不会被判处死刑？                                                                                    |      123 |
| 上海瑞金医院内一男子持刀伤人致 4 伤，涉事男子将承担哪些法律责任？                                                                                         |      122 |
| 据说《咒》很邪门，是真的吗？                                                                                                                              |      122 |
| 日语里的「猪突猛进」是什么含义？                                                                                                                          |      120 |
| 警方透露「枪击安倍嫌犯重复说难以理解的话，正慎重调查其是否具有刑事责任能力」，如何从法律角度解读？                                                        |      120 |
| 有些车主宁愿把车停在路边也不愿意花几百块钱租个车位是什么心理？                                                                                            |      119 |
| 7 月 10 日中国三人女篮击败澳大利亚队，获得亚洲杯冠军，如何评价本次比赛中国女篮的表现？                                                                    |      118 |
| 飞机上不打开飞行模式会被发现吗？                                                                                                                          |      116 |
| 如何看待周杰伦亲自弹钢琴为网友伴奏新歌《最伟大的作品》，周杰伦的钢琴水平究竟怎么样？                                                                      |      115 |
| 华南国家植物园在广州揭牌成立，是目前世界上最大的南亚热带植物园，你有哪些期待？                                                                            |      113 |
| 「中国复眼」开建，可实现千万公里外小行星探测成像，将对观测工作带来哪些帮助？对于我国航天事业有何意义？                                                    |      113 |
| 把还不会说话的婴儿聚到一起，不教他们说话，会产生新的语言吗？                                                                                              |      110 |
| 如何评价歌曲《孤勇者》的作词水平？                                                                                                                        |      108 |
| 为什么看完电影《咒》的大部分观众都很生气，甚至觉得晦气？                                                                                                  |      107 |
| 河南禹州新民生等村镇银行风险处置方案即将公布，后续进展会如何？                                                                                            |      107 |
| 国内哪个男演员适合演《三体》里的罗辑？                                                                                                                    |      106 |
| 网传一游客从泸定桥坠入大渡河，警方称「正在全力搜救」，目前救援进展如何？出游应注意什么？                                                                  |      105 |
| 请问乌克兰有那么多的核弹，就是销毁了也可以再造出来吧，为什么却造不出来呢？                                                                                |      103 |
| 如何看待红网论坛发布「关闭青少年游戏，是亿万家长和所有教师的呼声」？                                                                                      |      103 |
| 7 月 9 日河南省考近 20 万人弃考，出现这种现象的原因有哪些？                                                                                               |      103 |
| 安倍晋三遇刺会对 7 月 10 日日本参议院选举产生什么影响？                                                                                                   |      102 |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------+----------+
29 rows in set (0.06 sec)

mysql> select hit_at,title,visitCount,heat,ranking from record where visitCount=(select max(visitCount) from record);
+-------------------+-----------------------------------------+------------+------------+---------+
| hit_at            | title                                   | visitCount | heat       | ranking |
+-------------------+-----------------------------------------+------------+------------+---------+
| 1657590556.993771 | 有哪些让你感觉惊艳的名字？              |  613367489 | 6万热度    |      32 |
+-------------------+-----------------------------------------+------------+------------+---------+
1 row in set (0.03 sec)

